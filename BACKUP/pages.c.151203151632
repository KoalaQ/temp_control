#include<iom128v.h>
#include "main.h"
#include "lcd.h"
#include "time.h"
#include "timertask.h"
#include "key.h"
#include "delay.h"
#include "temp.h"
//************************
// ËùÓĞ½çÃæĞÅÏ¢ÔÚÕâÀï,ÓÃµ½È«¾Ö±äÁ¿£¬ 
// unsigned int pageNum;//µ±Ç°Ò³Ãæ£¬ÈçĞèÌø×ª¸Ä±äÕâ¸öÖµ¾ÍĞĞ
// unsigned int pageParam[5];//´«µİ²ÎÊı¡£½çÃæ¼ä²ÎÊıÔİ´æ
// unsigned int prePageNum;
//************************

//ÓÃÓÚÏÔµÚÒ»ĞĞÈÕÆÚĞÅÏ¢£¬ÆäÖĞPage1¡¢Page3 ¡¢Page8Ê¹ÓÃ£¬
//ÓÉ¶¨Ê±Æ÷´¥·¢¸Ãº¯Êı£¬½øÈëÕâÈı¸ö½çÃæÊÇÆô¶¯¶¨Ê±Æ÷£¬ÍË³öÊ±¹Ø±Õ
void pageTime(uint y){
                //¹Ø¶¨Ê±Æ÷
   lcd_write_str(0,y,"Ê±¼ä:");
   showTime_page(y);
                 //¿ª¶¨Ê±Æ÷ 
}
void pageTime2(uint y){
                //¹Ø¶¨Ê±Æ÷
   //lcd_write_str(0,y,"Ê±¼ä:");
   showTime_page(y);
                 //¿ª¶¨Ê±Æ÷ 
}
//page1,Ê×Ò³µÄ½çÃæ
void page1(void){
   uint cur=0;
   uchar keyV;
   uint i;//ÓÃÓÚÑ­»·
   uint y;//È·¶¨ÊÇÄÇ¸ö°ëÆÁÄ»
   prePageNum=1;//Ê×Ò³²»»áÔÙÓĞÉÏÒ»½çÃæ£¬ÕâÀïÉèÖÃ¡£ËäÈ»Î¥·´¹æÔò
   //³õÊ¼»¯ÆğÊ¼Ñ¡Ôñ
	 
   
   
   lcd_write_str(1,1," T1:100");
   lcd_write_char(5,1,0xA1);
   lcd_write_char_con(1,0xE6);
	
   
    lcd_write_str(6,1," T2:800");
	lcd_write_char(10,1,0xA1);
	lcd_write_char_con(1,0xE6);
	
    lcd_write_str(1,2," T3:Í£Ö¹");

    lcd_write_str(6,2," T4:¹ÊÕÏ");

	
	lcd_write_str(1,3,"¿ªÊ¼    ");
    lcd_write_str_con(3,"Í£Ö¹    ");
	lcd_write_str_con(3,"ÉèÖÃ");
	
	
	
	 
	cur=0;
	Set_White(2,1,3);
	while(1){
	 pageTime(0);
	for(i=0;i<4;i++){
	  if(i==0){
	    y=1;
	    lcd_write_pos(3,1);
	  }else if(i==1){
	    y=1;
	    lcd_write_pos(8,1);
	  }else if(i==2){
	    y=2;
	    lcd_write_pos(3,2);
	  }else if(i==3){
	    y=2;
	    lcd_write_pos(8,2);
	  }
	   switch(temps[i].flag){
	     case 0:
		   lcd_write_str_con(y,"Í£Ö¹");
		   break;
		 case 1:
		   lcd_write_str_con(y,"150");
		   break;
		 case 2:
		   lcd_write_str_con(y,"¹ÊÕÏ");
		   break;
		 case 3:
		   lcd_write_str_con(y,"ÔİÍ£");
		   break;
		 case 4:
		   lcd_write_str_con(y,"½áÊø");
		   break;
		 case 5:
		   lcd_write_str_con(y,"µÈ´ı");
		   break;
		 case 6:
		   lcd_write_str_con(y,"ÔİÍ£");
		   break;
		   break;
		 default:
		   break;
	   }
	}
	 keyV=KeyScan_once();
	 if(keyV=='a'){
	      //pageNum=8;//Ìø×ªµ½ÉèÖÃÊ±¼äµÄ½çÃæ
		   pageNum=8;
	   switch(cur){
		 case 0: 
		    Set_White_off(2,1,3);
		    break;
		 case 1:
		   Set_White_off(7,1,8);
		   break;
		 case 2:
		  Set_White_off(2,2,3);
		  break;
		 case 3:
		   Set_White_off(7,2,8);
		    break;
		case 5:
		    Set_White_off(6,3,7);
		    break;
		 case 6:
		   Set_White_off(10,3,11);
		    break;
		  default:
		   break;
		 }
	   return ;
	}else if(keyV=='d'){
	     switch(cur){
		  case 0:
		   Set_White_off(2,1,3);
		   Set_White(2,2,3);
		   cur=2;
		   break;
		  case 1:
		   Set_White_off(7,1,8);
		   Set_White(7,2,8);
		   cur=3;
		   break;
		  case 2:
		   Set_White_off(2,2,3);
		   Set_White(2,3,3);
		   cur=4;
		   break;
		  case 3:
		   Set_White_off(7,2,8);
		   Set_White(6,3,7);
		   cur=5;
		   break;
		  default:
		   break;
		 }
	}else if(keyV=='u'){switch(cur){
		  case 2:
		   Set_White_off(2,2,3);
		   Set_White(2,1,3);
		   cur=0;
		   break;
		  case 3:
		   Set_White_off(7,2,8);
		   Set_White(7,1,8);
		   cur=1;
		   break;
		  case 4:
		   Set_White_off(2,3,5);
		   Set_White(2,2,3);
		   cur=2;
		   break;
		  case 5:
		   Set_White_off(6,3,7);
		   Set_White(7,2,8);
		   cur=3;
		   break;
		  case 6:
		   Set_White_off(10,3,11);
		   Set_White(7,2,8);
		   cur=3;
		   break;
		  default:
		   break;
		 }
	}else if(keyV=='l'){switch(cur){
		  case 1:
		   Set_White_off(7,1,8);
		   Set_White(2,1,3);
		   cur=0;
		   break;
		  case 3:
		   Set_White_off(7,2,8);
		   Set_White(2,2,3);
		   cur=2;
		   break;
		  case 5:
		   Set_White_off(6,3,7);
		   Set_White(2,3,3);
		   cur=4;
		   break;
		  case 6:
		   Set_White_off(10,3,11);
		   Set_White(6,3,7);
		   cur=5;
		   break;
		  default:
		   break;
		 }
	}else if(keyV=='r'){
	switch(cur){
		  case 0:
		   Set_White_off(2,1,3);
		   Set_White(7,1,8);
		   cur=1;
		   break;
		  case 2:
		   Set_White_off(2,2,3);
		   Set_White(7,2,8);
		   cur=3;
		   break;
		  case 4:
		   Set_White_off(2,3,3);
		   Set_White(6,3,7);
		   cur=5;
		   break;
		  case 5:
		   Set_White_off(6,3,7);
		   Set_White(10,3,11);
		   cur=6;
		   break;
		  default:
		   break;
		 }
	}else if(keyV=='s'){
	   pageNum=5;
	   switch(cur){
		 case 0: 
		    Set_White_off(2,1,3);
		    break;
		 case 1:
		   Set_White_off(7,1,8);
		   break;
		 case 2:
		  Set_White_off(2,2,3);
		  break;
		 case 3:
		   Set_White_off(7,2,8);
		    break;
		case 5:
		    Set_White_off(6,3,7);
		    break;
		 case 6:
		   Set_White_off(10,3,11);
		    break;
		  default:
		   break;
		 }
	   return ;
	}else if(keyV=='t'){
	   switch(cur){
		 case 0: 
		    Set_White_off(2,1,3);
		    prePageNum=1;
		    pageParam[0]=0;//´«µİÊ¹ÓÃµÚÒ»¸ö£¬¶ÔÓ¦²»Í¬µÄÎÂ¶È
		    pageNum=3;
		    return;
		 case 1:
		   Set_White_off(7,1,8);
		    prePageNum=1;
		   pageParam[0]=1;//´«µİÊ¹ÓÃµÚÒ»¸ö£¬¶ÔÓ¦²»Í¬µÄÎÂ¶È
		    pageNum=3;
		    return;
		 case 2:
		  Set_White_off(2,2,3);
		    prePageNum=1;
		    pageParam[0]=2;//´«µİÊ¹ÓÃµÚÒ»¸ö£¬¶ÔÓ¦²»Í¬µÄÎÂ¶È
		   pageNum=3;
		   return;
		 case 3:
		   Set_White_off(7,2,8);
		     prePageNum=1;
		    pageParam[0]=3;//´«µİÊ¹ÓÃµÚÒ»¸ö£¬¶ÔÓ¦²»Í¬µÄÎÂ¶È
		    pageNum=3;
		    return;
		 case 4:
		    //µ÷ÓÃº¯ÊıÈ«²¿¿ªÊ¼£¬²ÎÊıÕıÈ·µÄ
		   break;
		 case 5:
		    //È«²¿Í£Ö¹
		   break;
		 case 6://ÖØÖÃ
		   Set_White_off(10,3,11);
		   pageParam[2]=0;//±íÊ¾ÊÇÏµÍ³ÖØÖÃ
		   prePageNum=1;
		   pageNum=5;
		    return;
		  default:
		   break;
		 }
	
	}
  }
   return;
}
 void page2(void){
   uint cur=0;
   uchar keyV;
   //³õÊ¼»­Ãæ£¬»áÓĞ¶ÁÈ¡EEPROMµÄÅĞ¶ÏÄ¬ÈÏ²Ù×÷£¬±¾´ÎÖ»ÊÇ»­½çÃæ
   lcd_write_str(2,0,"ÊÇ·ñ»Ö¸´ÉÏ´Î¹¤×÷");
   lcd_write_str(2,2,"»Ö¸´");
   lcd_write_str(8,2,"È¡Ïû");
   Set_White(3,2,4);
    while(1){
      keyV=KeyScan_once();
	  switch(keyV){
	    case 'l':
		   if(cur==1){
		      Set_White_off(9,2,10);
		      Set_White(3,2,4);
			  cur=0;
		   }
		   break;
		case 'r':
		   if(cur==0){
		      Set_White_off(3,2,4);
		      Set_White(9,2,10);
			  cur=1;
		   }
		  break;
		case 't':
		  //Ö´ĞĞÏà¹Ø²Ù×÷
		   Set_White_off(9,2,10);
		    Set_White_off(3,2,4);
		  pageNum=1;
		  return;
	  }
	}
 }
 void page3(void){
  uint cur=0;
   uchar keyV;
   lcd_write_str(0,0,"T");
    lcd_write_char_con(0,0x30 | (pageParam[0]+1));
	lcd_write_char_con(0,':');
   lcd_write_str(1,1,"ÎÂ¶È:");
   lcd_write_str(1,2,"×´Ì¬:");
   lcd_write_str(0,3,"±à¼­");
   lcd_write_str(3,3,"ÔËĞĞ");
   lcd_write_str(7,3,"ÔİÍ£");
   lcd_write_str(10,3,"ÖØÖÃ");
   Set_White(1,3,2);
   //Set_White(9,2,10);
    while(1){
	lcd_write_pos(2,0);
	pageTime2(0);
	 lcd_write_str(4,1,"100");
	 lcd_write_char(6,1,0xA1);
     lcd_write_char_con(1,0xE6);
	 lcd_write_str(4,2,"½×¶Î1");
	 lcd_write_str(8,2," 1:10");
	
      keyV=KeyScan_once();  
	  if(keyV=='e'){
	      Set_White_off(1,3,2);
		  Set_White_off(4,3,5);
		  Set_White_off(8,3,9);
		  Set_White_off(11,3,12);
		  pageNum=1;
		  return;
	  }else if(keyV=='l'){
	     switch(cur){
		   case 1:
		     Set_White_off(4,3,5);
		     Set_White(1,3,2);
			 cur=0;
		     break;
		   case 2:
		     Set_White_off(8,3,9);
		     Set_White(4,3,5);
		     cur=1;
		     break;
		   case 3:
		     Set_White_off(11,3,12);
		     Set_White(8,3,9);
		     cur=2;
		     break;
		 }
	  }else if(keyV=='r'){
	       switch(cur){
		   case 0:
		     Set_White(4,3,5);
		     Set_White_off(1,3,2);
			 cur=1;
		     break;
		   case 1:
		     Set_White(8,3,9);
		     Set_White_off(4,3,5);
		     cur=2;
		     break;
		   case 2:
		     Set_White(11,3,12);
		     Set_White_off(8,3,9);
		     cur=3;
		     break;
		 }
	  }else if(keyV=='t'){
	       switch(cur){
		   case 0:
		     Set_White_off(1,3,2);
			 pageNum=4;
		     return;
		   case 1:
		     //ÔËĞĞ²Ù×÷
		     break;
		   case 2:
		     //ÔİÍ£²Ù×÷
		     break;
		  case 3:
		     //ÖØÖÃ²Ù×÷
		     break;
		 }
	  }else if(keyV=='s'){
	       Set_White_off(1,3,2);
		   Set_White_off(4,3,5);
		   Set_White_off(8,3,9);
		   Set_White_off(11,3,12);
			pageNum=4;
		     return;
	  }
	}
 }
 //µÈÏÂµ÷ÓÃpage_ac()º¯Êı¸Ä±äacĞ´Êı¾İ
 void page4_data(uint y,uint* dataCach){
      uint numH=0xA2;
      uint numL=0xC4;//´øÀ¨ºÅµÄ123£¬µÍÎ»¼Ó1ÊÇ1¡¢·½±ã²Ù×÷£¬ĞèÒª¼ÓÉÏ¼´¿É
	  uint i=0;
	  uint beginCur=0;
    //Õâ¸öÅĞ¶ÏĞèÒªĞ©µ½¶ÁÈ¡Öµº¯ÊıÖĞÈ¥
	 if(y<3){
	   lcd_write_char(2,1,numH);
       lcd_write_char_con(1,numL+1);
	   lcd_write_char(2,2,numH);
       lcd_write_char_con(2,numL+2);
       lcd_write_char(2,3,numH);
       lcd_write_char_con(3,numL+3);
	   y=0;
	  }else if(y>=3 && y<6){
	   lcd_write_char(2,1,numH);
       lcd_write_char_con(1,numL+4);
	   lcd_write_char(2,2,numH);
       lcd_write_char_con(2,numL+5);
       lcd_write_char(2,3,numH);
       lcd_write_char_con(3,numL+6);
	   y=1;
	  }else if(y>=6 && y<9){
	   lcd_write_char(2,1,numH);
       lcd_write_char_con(1,numL+7);
	   lcd_write_char(2,2,numH);
       lcd_write_char_con(2,numL+8);
       lcd_write_char(2,3,numH);
       lcd_write_char_con(3,numL+9);
	   y=2;
	  }else if(y>=9 && y<12){
	   lcd_write_char(2,1,numH);
       lcd_write_char_con(1,numL+10);
	   lcd_write_char(2,2,numH);
       lcd_write_char_con(2,numL+11);
       lcd_write_char(2,3,numH);
       lcd_write_char_con(3,numL+12);
	   y=3;
	  }
	  //»¹Òª×öÊı¾İ¶ÁÈ¡²Ù×÷
	  beginCur=y*33;//»ñµÃÊ×¸öÊı¾İ
	  for(i=1;i<=3;i++){
	    if(i==1){//µÚÒ»´Î½øÈëĞèÒªÅĞ¶Ï£¬Ê×Î»Ğ´²»ĞíÓÃ++
		 lcd_write_char(3,i,0x30 | *(dataCach+beginCur));
		}else{
		 lcd_write_char(3,i,0x30 | *(dataCach+(++beginCur)));
		}
        lcd_write_char_con(i,0x30 | *(dataCach+(++beginCur)));
		 lcd_write_str_con(i,": ");
	     lcd_write_char_con(i,0x30 | *(dataCach+(++beginCur)));
		 lcd_write_char_con(i,0x30 | *(dataCach+(++beginCur)));
		 
		 lcd_write_char(7,i,0x30 | *(dataCach+(++beginCur)));
		 lcd_write_char_con(i,0x30 | *(dataCach+(++beginCur)));
		  lcd_write_str_con(i,": ");
		 lcd_write_char_con(i,0x30 | *(dataCach+(++beginCur)));
		 lcd_write_char_con(i,0x30 | *(dataCach+(++beginCur)));
		 
		 lcd_write_str(10,i," ");
		 lcd_write_char_con(i,0x30 | *(dataCach+(++beginCur)));
		 lcd_write_char_con(i,0x30 | *(dataCach+(++beginCur)));
		 lcd_write_char_con(i,0x30 | *(dataCach+(++beginCur)));
	  }
	  
 }
 //´«Èëcur×öacÎ»ÖÃ²Ù×÷,ÅĞ¶ÏÊÇ·ñ·­Ò³
 void page4_ac(uint cur,uint oldcur,uint* dataCach){
      uint y=cur/11;//Âß¼­y.´Ó0¿ªÊ¼
	  uint lcd_y;//ÏÔÊ¾y
	  uint x=cur%11;//xÖá
	  switch(y%3){
	   case 0://1ĞĞ
	     lcd_y=1;
	     break;
	   case 1://2ĞĞ
	     lcd_y=2;
		 break;
	   case 2://3ĞĞ
	     lcd_y=3;
	     break;
	  }
	  switch((oldcur/11)/3){
	    case 0:
		 if(cur>32){
		   page4_data(y,dataCach);
		 }
		 break;
		case 1:
		  if(cur>65 || cur<33){
		   page4_data(y,dataCach);
		 }
		 break;
		case 2:
		if(cur<66 || cur>98){
		   page4_data(y,dataCach);
		 }
		 break;
		case 3:
		if(cur<99){
		   page4_data(y,dataCach);
		 }
		 break;
	  }
	  if(lcd_y==1){
	     cur_set(3);
		 cur_set(4);
	  }else if(lcd_y==2 || lcd_y==3){
	     cur_set(0);
		 cur_set(7);
	  }
	  if(x==0){
	      lcd_write_pos(3,lcd_y);
	  }else if(x==2){
	       lcd_write_pos(5,lcd_y);
	  }else if(x==4){
	        lcd_write_pos(7,lcd_y);
	  }else if(x==6){
	        lcd_write_pos(9,lcd_y);
	  }else if(x==8){
	        lcd_write_pos(10,lcd_y);
			lcd_write_str_con(lcd_y," ");
	  }else if(x==9){
	        lcd_write_pos(11,lcd_y);
	  }
	  return;
 }
  void page4(void){
    //¶¨ÒåÒ»¸ö¾Ö²¿µÄ½á¹¹Ìå£¬´Ó¶ÔÑ½ÎÂ¶ÈÖĞ»ñµÃÊı¾İ¡£ÔİÊ±Î´Ğ´
  uint numH=0xA2;
  uint numL=0xC4;//´øÀ¨ºÅµÄ123£¬µÍÎ»¼Ó1ÊÇ1¡¢·½±ã²Ù×÷£¬ĞèÒª¼ÓÉÏ¼´¿É
  uint cur=0;
  uint oldcur=0;
  uint dataCach[131]={0};
  uint i=0;
   uchar keyV;
   lcd_write_str(0,0,"T");
   lcd_write_char_con(0,0x30 | (pageParam[0]+1));
   lcd_write_char_con(0,':');
   
   lcd_write_str(4,0,"ÉıÎÂ");
   lcd_write_str(7,0,"ºãÎÂ");
   lcd_write_str(10,0,"ÎÂ¶È");
   lcd_write_str(0,1,"±£´æ");
   lcd_write_str(0,2,"È¡Ïû");
   lcd_write_str(0,3,"ÖØÖÃ");
  
  for(i=0;i<132;i++){
    dataCach[i]=temps[pageParam[0]].temp_data[i];
  }
    page4_data(0,dataCach);//µ÷ÓÃº¯ÊıÌî³ä
   cur=0;
   lcd_write_pos(3,1);
   cur_set(3);
   
   //Set_White(9,2,10);
    while(1){
      keyV=KeyScan_once();
	  if(keyV=='e'){
	        Set_White_off(1,1,2);
			Set_White_off(1,2,2);
			Set_White_off(1,3,2);
			cur_set(0);
			cur_set(4);
		    pageNum=3;
		    return;
	  }else if(keyV=='u'){
	     if(cur==133){
		    Set_White(1,1,2);
			Set_White_off(1,2,2);
			cur=132;
		 }else if(cur==134){
		    Set_White(1,2,2);
			Set_White_off(1,3,2);
			cur=133;
		 }else if(cur>10 && cur<=131){
		   oldcur=cur;
	       cur=(cur/11-1)*11;
		   page4_ac(cur,oldcur,dataCach);
		 }
	  }else if(keyV=='d'){
	     if(cur==132){
		    Set_White_off(1,1,2);
			Set_White(1,2,2);
			cur=133;
		 }else if(cur==133){
		    Set_White_off(1,2,2);
			Set_White(1,3,2);
			cur=134;
		 }else if(cur<121){
	      oldcur=cur;
	      cur=(cur/11+1)*11;
		  page4_ac(cur,oldcur,dataCach);
		}
		
	  }else if(keyV=='l'){
	   oldcur=cur;
	  if(cur%11==0){
	        Set_White(1,1,2);
			cur_set(0);
			cur_set(4);
			cur=132;
	   }else if(cur%11==2 || cur%11==4 || cur%11==6 || cur%11==8){
	      cur-=2;
		   page4_ac(cur,oldcur,dataCach);
		}else if(cur>0){
	      cur--;
		   page4_ac(cur,oldcur,dataCach);
		}
	  
	  }else if(keyV=='r'){
	  if(cur>131){
	      Set_White_off(1,1,2);
	      Set_White_off(1,2,2);
		  Set_White_off(1,3,2);
		  cur=oldcur;
	  }else  if(cur<131){
		 oldcur=cur;
	     cur++;
		 }
	    page4_ac(cur,oldcur,dataCach);
	  }else if(keyV=='t'){	    
	     if(cur==132){
		   Set_White_off(1,1,2);
			Set_White_off(1,2,2);
			Set_White_off(1,3,2);
		   cur_set(0);
			cur_set(4);
		    pageParam[1]=1;//±íÊ¾ÊÇÎÂ¶ÈÊı¾İµÄ£¬ÕâÀï´¦Àí±£´æµÄ·½·¨£¬ÒòÎªÊı¾İÔÚÕâÀï¡£Ö»ÊÇÌø×ª¹ıÈ¥£¬²ÎÊıÈç¹ûÊÇ1±íÊ¾³É¹¦¡£2±íÊ¾Ê§°Ü
		    prePageNum=4;
		    pageNum=6;
			set_temp_data(pageParam[0],dataCach);//±£´æÊı¾İ
		    return;
		 }else if(cur==133){
		    Set_White_off(1,1,2);
			Set_White_off(1,2,2);
			Set_White_off(1,3,2);
		    cur_set(0);
			cur_set(4);
		    pageNum=3;
		    return;
		 }else if(cur==134){
		    Set_White_off(1,1,2);
			Set_White_off(1,2,2);
			Set_White_off(1,3,2);
		   cur_set(0);
			cur_set(4);
		   //ÖØÖÃ¡£ÓĞÌáÊ¾
			pageParam[2]=1;//±íÊ¾ÖØÖÃÊÇÎÂ¶ÈÊı¾İµÄ
			prePageNum=4;
		    pageNum=7;
		    return;
		 }
	     
	  }else if(keyV=='0' || keyV=='1' || keyV=='2' || keyV=='3' || keyV=='4' || keyV=='5' 
	           || keyV=='6'  || keyV=='7' || keyV=='8' || keyV=='9'){
			  if(cur <132){//ÅĞ¶Ï»¹ÔÚÊäÈëÓò
			   if((cur/11)%3==0){
			      lcd_write_char_con(1,0x30 | keyV);
				}else{
				  lcd_write_char_con(2,0x30 | keyV);
				}
				dataCach[cur]=keyV;
				oldcur=cur;
				if(cur<131)
				{
				  cur++;
				  page4_ac(cur,oldcur,dataCach);
				}else if(cur==131){//×îºóÒ»¸ö131»áÔÚÉÏÃæ´¦Àí£¬×îºóÒ»´Î½øÈëÕâÀï¡£Ìøµ½±£´æ
				  Set_White(1,1,2);
			       cur_set(0);
			       cur_set(4);
			       cur=132;
				   oldcur=99;
				}
				
			  }
		}
	}
 }
 
 void page5(void){
  uint cur=0;
   uchar keyV;
   lcd_write_str(4,0,"¶Ïµç×Ô¶¯ÖØÖÃ");
   lcd_write_str(4,1,"ÉèÖÃÊ±¼ä");
   lcd_write_str(4,2,"ÖØÖÃÏµÍ³");
   lcd_write_char(3,0,0xA1);
   lcd_write_char_con(0,0xC1);
   
   /* lcd_write_char(1,0,0xA1);
   lcd_write_char_con(0,0xCC);*/
   cur=0;
   Set_White(5,0,10);
   while(1){
      keyV=KeyScan_once();
	  if(keyV=='u'){
	    switch(cur){
		  case 1:
		   Set_White_off(5,1,8);
		   Set_White(5,0,10);
		   cur=0;
		   break;
		  case 2: 
		   Set_White_off(5,2,8);
		   Set_White(5,1,8);
		   cur=1;
		   break;
		}
	  }else if(keyV=='d'){
	      switch(cur){
		  case 0:
		   Set_White_off(5,0,10);
		   Set_White(5,1,8);
		   cur=1;
		   break;
		  case 1: 
		   Set_White_off(5,1,8);
		   Set_White(5,2,8);
		   cur=2;
		   break;
		}
	  }else if(keyV=='e'){
	     switch(cur){
		 case 0: 
		   Set_White_off(5,0,10);
		    break;
		 case 1:
		   Set_White_off(5,1,8);
		   break;
		 case 2:
		  Set_White_off(5,2,8);
		  break;
	
		  default:
		   break;
		 }
	    pageNum=1;
		return;
	  }else if(keyV=='t'){
	    switch(cur){
		  case 0:
		     //Ö´ĞĞEEPROM²Ù×÷
		    break;
		  case 1:
		   pageNum=8;
		   Set_White_off(5,1,8);
		   return;
		  
		  case 2://ÖØÖÃÏµÍ³»
		    prePageNum=5;
		    pageNum=7;
			pageParam[2]=0;
		    Set_White_off(5,2,8);
		   return;
		}
	    
	  }
   }
   
 }
 void page6(void){//¸´ÓÃµÄ·½·¨
 if(pageParam[1]==0){
     lcd_write_str(4,1,"Ê±¼ä±£´æ³É¹¦£¡");
   }else if(pageParam[1]==1){
     lcd_write_str(4,1,"ÎÂ¶È±£´æ³É¹¦£¡");
   }else if(pageParam[1]==2){
     lcd_write_str(4,1,"ÎÂ¶È±£´æÊ§°Ü£¡");
   }
   delay_ms(500);
   pageNum=prePageNum;
 }
 void page7(void){
   uint cur=1;
   uchar keyV;
   lcd_write_str(2,0,"ÊÇ·ñÖØÖÃ");
   lcd_write_str(2,2,"È·ÈÏ");
   lcd_write_str(8,2,"È¡Ïû");
   Set_White(9,2,10);
    while(1){
      keyV=KeyScan_once();
	  switch(keyV){
	    case 'l':
		   if(cur==1){
		      Set_White_off(9,2,10);
		      Set_White(3,2,4);
			  cur=0;
		   }
		   break;
		case 'r':
		   if(cur==0){
		      Set_White_off(3,2,4);
		      Set_White(9,2,10);
			  cur=1;
		   }
		  break;
		case 't':
		  //Ö´ĞĞÏà¹Ø²Ù×÷	  
		  if(cur==0){
		     Set_White_off(3,2,4);
		       //½øÈëÖØÖÃ»­Ãæ¡£ÔÚPage9Æô¶¯¿´ÃÅ¹·ÖØÖÃÏµÍ³¡¢²»Î¹¹·¡£Êı¾İÖØÖÃ¶ÔÑ½²Ù×÷²»Í¬
		       pageNum=9;
		  }else {
		      Set_White_off(9,2,10);
		       pageNum=prePageNum;
		  }
		  return;
		 case 'e':
		    Set_White_off(3,2,4);
		    Set_White_off(9,2,10);
		    pageNum=prePageNum;
		    return;
	  }
	}
 }
 //ÓÉÓÚÊ¹ÓÃDS1307£¬ÔİÊ±²»×ö¶ÁÈ¡ºÍ±£´æÊ±¼äµÄ¡£µÈÊµÊ±Ê±ÖÓÄ£¿éÂòÀ´
 void page8(void){
   uint cur=0;
   uchar keyV;
   uchar date[15];
   uint i;
    uint dateAc[14]={1,2,3,4,6,7,9,10,2,3,5,6,8,9};
	
   date[0]=2;
   date[1]=0;
   date[2]=1;
   date[3]=5;
   date[4]=1;
   date[5]=2;
   date[6]=2;
   date[7]=5;
   date[8]=1;
   date[9]=2;
   date[10]=3;
   date[11]=0;
   date[12]=5;
   date[13]=0;
    lcd_write_pos(1,0);
  for(i=0;i<8;i++){
   lcd_write_char_con(0,0x30 | date[i]);
    lcd_write_char_con(0,' ');
	if(i==3 || i==5){
	  lcd_write_str_con(0,"- ");
	}
  }
   lcd_write_pos(2,1);
   for(i=8;i<14;i++){
   lcd_write_char_con(1,0x30 | date[i]);
   lcd_write_char_con(0,' ');
   if(i==9 || i==11){
	 lcd_write_str_con(0,": ");
   }
  } 
   lcd_write_str(3,2,"±£´æ");
   lcd_write_str(8,2,"È¡Ïû");
   //³õÊ¼»¯date
  
   cur=0;
   lcd_write_pos(1,0);//³õÊ¼ÓÎ±êÎ»ÖÃ
   cur_set(3);//ÉÏ°ëÆÁÄ»ÓÎ±êÉèÖÃ
   while(1){
     pageTime(3);//
	 keyV=KeyScan_once();
	 if(keyV=='u'){
	   if(cur>13){//µ÷µ½Ê±¼äµÚÒ»¸ö
	        Set_White_off(4,2,5);
			Set_White_off(9,2,10);
	        lcd_write_pos(2,1);
		    cur_set(3);
			cur=8; 
		   }else if(cur>7 && cur <14){//µ÷µ½ÈÕÆÚµÚÒ»¸ö
		    lcd_write_pos(1,0);
			cur=0; 
		   }
	 }else if(keyV=='d'){
	     if(cur>7 && cur <14){//ÔÚÊ±¼äÉÏ£¬µÚÈıĞĞ£¬Ä¬ÈÏÒª±£´æ£¬ËùÒÔµ÷µ½±£´æÉÏ
		      cur_set(0);//¹ØÏÂ°ëÆÁÄ»ÓÎ±ê
			  Set_White(4,2,5);
			  cur=14;
		 }else if(cur<=7){ //µ÷µ½Ê±¼äµÚÒ»¸ö
		    lcd_write_pos(2,1);
			cur=8; 
		 }
	 }else if(keyV=='l'){
			if(cur<=8 && cur>0){
			 cur--;
			 lcd_write_pos(dateAc[cur],0);
			}else if (cur>8 && cur<14){
			 cur--;
			 lcd_write_pos(dateAc[cur],1);
			}else if (cur==15){
			    Set_White_off(9,2,10);
			    Set_White(4,2,5);
				cur=14;
			}
			
		
	 }else if(keyV=='r'){
	       if(cur<7){
			   cur++;
			   lcd_write_pos(dateAc[cur],0);
			}else if (cur<13){
			   cur++;
			   lcd_write_pos(dateAc[cur],1);
			}else if (cur==14){
			    Set_White_off(4,2,5);
				Set_White(9,2,10);
				cur=15;
			}
	 }else if(keyV=='e'){
	     cur_set(0);//¹ØÉÏ°ëÆÁÄ»ÓÎ±ê
		  Set_White_off(4,2,5);
		  Set_White_off(9,2,10);
		 pageNum=1;
		 return;
	     //ÍË³ö½çÃæ
	 }else if(keyV=='t'){
	      if(cur==14){
		        //±£´æ²Ù×÷
				pageParam[1]=0;//±ê¼ÇÊÇÊ±¼äµÄ±£´æ
				prePageNum=8;
				pageNum=6;
				return;
		 }else if(cur==15){
		        //È¡Ïû²Ù×÷
			 cur_set(0);//¹ØÉÏ°ëÆÁÄ»ÓÎ±ê
		  Set_White_off(4,2,5);
		  Set_White_off(9,2,10);
		 pageNum=1;
		 return;
		 }
	 }else if(keyV=='0' || keyV=='1' || keyV=='2' || keyV=='3' || keyV=='4' || keyV=='5' 
	           || keyV=='6'  || keyV=='7' || keyV=='8' || keyV=='9'){
			if(cur<14){
			 lcd_write_char_con(0,0x30 | keyV);
			 lcd_write_char_con(0,' ');
			 date[cur]=keyV;
			  if(cur==3 || cur==5){
			    lcd_write_str_con(0,"- ");
			 }else if(cur==9 || cur==11){
			    lcd_write_str_con(0,": ");
			 }
			 cur++;
			 if(cur==8){
			    lcd_write_pos(dateAc[8],1);
			 }else if(cur==14){
			  cur_set(0);//¹ØÏÂ°ëÆÁÄ»ÓÎ±ê
			  Set_White(4,2,5);
			 }
			}
	 }
   }
 }
void page9(void){//¸´ÓÃµÄ·½·¨
  if(pageParam[2]==0){
     lcd_write_str(4,1,"ÏµÍ³ÖØÖÃÖĞ¡£¡£¡£");
   }else if(pageParam[2]==1){
     
     lcd_write_str(4,1,"Êı¾İÖØÖÃÖĞ¡£¡£¡£");
   }
   delay_ms(500);
   pageNum=prePageNum;
 }
//·Ö·¢Pages
void dispatchPages(void){
      lcd_clear();//ÇåÆÁÄ»
      if(pageNum==1){
	    page1();
	  }else if(pageNum==2){
	    page2();
	  }else if(pageNum==3){
	    page3();
	  }else if(pageNum==4){
	    page4();
	  }else if(pageNum==5){
	    page5();
	  }else if(pageNum==6){
	    page6();
	  }else if(pageNum==7){
	    page7();
	  }else if(pageNum==8){
	    page8();
	  }else if(pageNum==9){
	    page9();
	  }
	         
}